@model OrderCreateModel

@section Bar {
    <section class="py-3 shadow-sm"
             style="background: linear-gradient(90deg, #1a1a2e 0%, #16213e 100%); border-bottom: 1px solid rgba(255, 255, 255, 0.05);">
        <div class="container">
            <nav aria-label="breadcrumb">
                <ol class="breadcrumb mb-0">
                    <li class="breadcrumb-item">
                        <a href="/" class="text-decoration-none d-inline-flex align-items-center breadcrumb-link">
                            <i class="fa-solid fa-house me-2"></i>Anasayfa
                        </a>
                    </li>
                    <li class="breadcrumb-item active d-inline-flex align-items-center" aria-current="page">
                        Ödeme ve Adres Bilgileri
                    </li>
                </ol>
            </nav>
        </div>
    </section>

    <style>
        .breadcrumb-link { color: rgba(255, 255, 255, 0.6) !important; transition: 0.3s; font-size: 0.9rem; }
        .breadcrumb-link:hover { color: #fff !important; }
        .breadcrumb-item.active { color: #fbc531 !important; font-weight: 600; font-size: 0.9rem; }
        .breadcrumb-item+.breadcrumb-item::before { color: rgba(255, 255, 255, 0.3) !important; content: "\f105"; font-family: "Font Awesome 6 Free"; font-weight: 900; }
        .form-control:focus { box-shadow: 0 0 0 0.25 margin-left: rgba(13, 110, 253, 0.1); border: 1px solid #4b6cb7 !important; }
    </style>
}

<form asp-controller="Order" asp-action="CheckOut" method="post" class="mt-5 mb-5">
    <div class="container">
        <div class="row g-4">
            @* SOL TARAF: Teslimat ve Kart Bilgileri *@
            <div class="col-lg-8">
                
                @* 1. TESLİMAT BİLGİLERİ KARTI *@
                <div class="card border-0 shadow-sm mb-4" style="background: rgba(255, 255, 255, 0.9); backdrop-filter: blur(15px); border-radius: 20px; border: 1px solid rgba(0,0,0,0.05);">
                    <div class="card-header bg-transparent border-0 pt-4 ps-4">
                        <h2 class="h4 fw-bold text-dark mb-0">
                            <i class="bi bi-geo-alt-fill me-2 text-primary"></i>Teslimat Bilgileri
                        </h2>
                    </div>
                    <div class="card-body p-4">
                        <div class="row g-3">
                            <div asp-validation-summary="ModelOnly" class="text-danger small"></div>
                            <div class="col-12">
                                <label asp-for="Fullname" class="form-label small fw-bold text-uppercase text-muted ms-1"></label>
                                <input asp-for="Fullname" class="form-control form-control-lg border-0 shadow-sm bg-white" style="border-radius: 12px;" placeholder="Adınız Soyadınız">
                                <span asp-validation-for="Fullname" class="text-danger small"></span>
                            </div>

                            <div class="col-md-4">
                                <label asp-for="City" class="form-label small fw-bold text-uppercase text-muted ms-1"></label>
                                <input asp-for="City" class="form-control border-0 shadow-sm bg-white py-2" style="border-radius: 12px;" placeholder="Şehir">
                                <span asp-validation-for="City" class="text-danger small"></span>
                            </div>
                            <div class="col-md-4">
                                <label asp-for="Phone" class="form-label small fw-bold text-uppercase text-muted ms-1"></label>
                                <input asp-for="Phone" class="form-control border-0 shadow-sm bg-white py-2" style="border-radius: 12px;" placeholder="05xx xxx xx xx">
                                <span asp-validation-for="Phone" class="text-danger small"></span>
                            </div>
                            <div class="col-md-4">
                                <label asp-for="PostalCode" class="form-label small fw-bold text-uppercase text-muted ms-1"></label>
                                <input asp-for="PostalCode" class="form-control border-0 shadow-sm bg-white py-2" style="border-radius: 12px;" placeholder="34000">
                                <span asp-validation-for="PostalCode" class="text-danger small"></span>
                            </div>

                            <div class="col-12 mt-3">
                                <label asp-for="Address" class="form-label small fw-bold text-uppercase text-muted ms-1"></label>
                                <textarea asp-for="Address" class="form-control border-0 shadow-sm bg-white" rows="2" style="border-radius: 12px;" placeholder="Tam adresinizi buraya yazınız..."></textarea>
                                <span asp-validation-for="Address" class="text-danger small"></span>
                            </div>

                            <div class="col-12 mt-3">
                                <label asp-for="OrderNote" class="form-label small fw-bold text-uppercase text-muted ms-1"></label>
                                <textarea asp-for="OrderNote" class="form-control border-0 shadow-sm bg-white" rows="1" style="border-radius: 12px;" placeholder="Varsa sipariş notunuz..."></textarea>
                            </div>
                        </div>
                    </div>
                </div>

                @* 2. ÖDEME (KART) BİLGİLERİ KARTI *@
                <div class="card border-0 shadow-sm" style="background: rgba(255, 255, 255, 0.9); backdrop-filter: blur(15px); border-radius: 20px; border: 1px solid rgba(0,0,0,0.05);">
                    <div class="card-header bg-transparent border-0 pt-4 ps-4">
                        <h2 class="h4 fw-bold text-dark mb-0">
                            <i class="bi bi-credit-card-2-back-fill me-2 text-primary"></i>Kart Bilgileri
                        </h2>
                    </div>
                    <div class="card-body p-4">
                        <div class="row g-3">
                            <div class="col-md-8">
                                <label asp-for="CartName" class="form-label small fw-bold text-uppercase text-muted ms-1">Kart Üzerindeki İsim</label>
                                <input asp-for="CartName" class="form-control border-0 shadow-sm bg-white py-2" style="border-radius: 12px;" placeholder="AD SOYAD">
                            </div>
                            <div class="col-md-4">
                                <label class="form-label small fw-bold text-uppercase text-muted ms-1">Kart Tipi</label>
                                <div class="d-flex gap-2 align-items-center pt-1">
                                    <i class="fab fa-cc-visa text-primary fs-3"></i>
                                    <i class="fab fa-cc-mastercard text-danger fs-3"></i>
                                </div>
                            </div>
                            <div class="col-md-12">
                                <label asp-for="CartNumber" class="form-label small fw-bold text-uppercase text-muted ms-1">Kart Numarası</label>
                                <input asp-for="CartNumber" class="form-control border-0 shadow-sm bg-white py-2" style="border-radius: 12px;" placeholder="**** **** **** ****">
                            </div>
                            <div class="col-md-4">
                                <label asp-for="CartExpirationMonth" class="form-label small fw-bold text-uppercase text-muted ms-1">Ay</label>
                                <select asp-for="CartExpirationMonth" class="form-select border-0 shadow-sm bg-white" style="border-radius: 12px;">
                                    @for(int i=1; i<=12; i++) { <option value="@i">@i.ToString("D2")</option> }
                                </select>
                            </div>
                            <div class="col-md-4">
                                <label asp-for="CartExpirationYear" class="form-label small fw-bold text-uppercase text-muted ms-1">Yıl</label>
                                <select asp-for="CartExpirationYear" class="form-select border-0 shadow-sm bg-white" style="border-radius: 12px;">
                                    @for(int i=2024; i<=2035; i++) { <option value="@i">@i</option> }
                                </select>
                            </div>
                            <div class="col-md-4">
                                <label asp-for="CartCVV" class="form-label small fw-bold text-uppercase text-muted ms-1">CVV</label>
                                <input asp-for="CartCVV" class="form-control border-0 shadow-sm bg-white py-2" style="border-radius: 12px;" placeholder="***">
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            @* SAĞ TARAF: SİPARİŞ ÖZETİ (Sticky) *@
            <div class="col-lg-4">
                <div class="card border-0 shadow-lg text-white"
                     style="background: linear-gradient(135deg, #4b6cb7 0%, #182848 100%); border-radius: 25px; position: sticky; top: 20px;">
                    <div class="card-header bg-transparent border-0 pt-4 ps-4">
                        <h2 class="h5 mb-0 fw-bold text-uppercase letter-spacing-1">Sipariş Özeti</h2>
                    </div>
                    <div class="card-body p-4">
                        <div class="flex-grow-1 overflow-auto" style="max-height: 300px;">
                            @foreach (var item in ViewBag.Cart.CardItems)
                            {
                                <div class="d-flex justify-content-between align-items-center mb-3 p-2 rounded-3"
                                     style="background: rgba(255, 255, 255, 0.1);">
                                    <div class="me-2">
                                        <p class="mb-0 fw-bold small text-truncate" style="max-width: 150px;">@item.Product.Name</p>
                                        <span class="badge bg-light text-dark rounded-pill" style="font-size: 0.65rem;">x @item.Quantity</span>
                                    </div>
                                    <span class="fw-bold small">@((item.Product.Price * item.Quantity).ToString("C2"))</span>
                                </div>
                            }
                        </div>

                        <div class="mt-4 pt-3 border-top border-white border-opacity-25">
                            <div class="d-flex justify-content-between align-items-center mb-2 opacity-75">
                                <span class="small">Ara Toplam</span>
                                <span class="fw-medium">@ViewBag.Cart.SubTotal().ToString("C2")</span>
                            </div>
                            <div class="d-flex justify-content-between align-items-center mt-3">
                                <span class="h5 fw-light mb-0">Toplam</span>
                                <span class="h3 mb-0 fw-bolder">@ViewBag.Cart.TotalPrice().ToString("C2")</span>
                            </div>
                        </div>

                        <button type="submit" class="btn btn-light btn-lg w-100 mt-4 py-3 fw-bold shadow-sm"
                                style="border-radius: 15px; transition: 0.3s;"
                                onmouseover="this.style.transform='scale(1.02)'"
                                onmouseout="this.style.transform='scale(1)'">
                            SİPARİŞİ TAMAMLA <i class="bi bi-shield-check ms-2"></i>
                        </button>
                        
                        <div class="text-center mt-3 opacity-50 small">
                            <i class="bi bi-lock-fill me-1"></i> 256-bit Güvenli Ödeme
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</form>